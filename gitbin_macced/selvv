#!/bin/bash

function whatis() {
	cuseco=$(basename $0)
 echo -e "\033[38;5;118m${cuseco}	‚áí 	\\033[38;5;11mtype:\\033[38;5;118mvio-basadmin ‚Üí select, vim , mv, cp, vlc ; improved para git ‚Üí out vers-his, .git"
echo -e "	\\033[38;5;195m SELECT \\033[38;5;11mfile as default \\033[38;5;195m from \\033[38;5;11mhere as default \\033[38;5;195m by name \\033[38;5;11mas default \\033[38;5;11m‚≠ê\\033[38;5;195m and \\033[38;5;9mVIM\\033[38;5;195m it \\033[38;5;11m(as default)\\033[38;5;195m !!! \\033[38;5;11m‚≠ê\\033[38;5;195m \\033[38;5;212m‚ù§Ô∏èÔ∏è \\n\\033[38;5;43m\tüëâ\t\033[38;5;11m${cuseco} TERM* \\n \\033[38;5;195m ... per sigo investgando c√≥mo hacerlo bien, para excluya paths sin grep -v...
üí• \033[38;5;118m recuerda meter findterm\033[38;5;11m!!!\033[38;5;118m este select funciona d√°ndole un par√°metro name que acote el find\033[38;5;11m!! \033[38;5;118m:( NO vale el \033[38;5;11m'\033[38;5;118m*\033[38;5;11m' a secas üí•üí•üí•üí•üí• \033[0m"
}

## SOURCES 
##VARS-FILES
##FUNCTIONS
source Opte.fu
source Asksure.fu

function getwhereto() {
	echo -e "üí´\033[38;5;118m where or what to \\033[38;5;11m?????"	
	read where 
}

##DIRECTORIES
ddir=$(pwd)
##FILES 
#VARIABLES

what=vim
whereto=false
findterm=$1
cleanit=false

while getopts ":ehwvo" o; do
	case ${o} in
		e)
			opte
			exit
			;;
		h)
			whatis
			exit
			;; 
		w)
			echo -e "\033[38;5;14m" 
			findterm=$2 #NOTA ‚áí  con la expansi√≥n * al lanzar selvv, si findterm es $2, solo me coje el segundo, y no toda la expansi√≥n
			[[ ${@: -1} =~ "-" ]] && what=$(echo ${@: -1} | sed -ne 's/-//p') && set -- "${@:1:$(($#-1))}" || read -p " whaaaatt?? ‚Üí " what
			;;
		v)	echo -e "\033[38;5;14m" 
			findterm=$2 #NOTA ‚áí  con la expansi√≥n * al lanzar selvv, si findterm es $2, solo me coje el segundo, y no toda la expansi√≥n
			what=vlc
			cleanit=true
			;;
		o)
			findterm=$2
			read -p "default cat or enter command ‚Üí " what
			[[ ${what} == "" ]] && what=cat 
			;;
		?)
			echo -e "Nein nein nein option ‚Üí ${o}"
			exit
			;;
	esac
done
shift $((OPTIND-1))

### MAIN
if [[ ${@: -1} == "m" || ${@: -1} == "c" ]]; then
	whereto=true
	findopts=${@: -2}
	echo -e "findopts ‚Üí ${findopts} " 
	[[ ${@: -1} == "m" ]] && what="mv" || what="cp -r"
else
	# ATT si tengo problemas pueden estar aqu√≠, porque ... no s√© por qu√© pero en alg√∫n edit el caso es que dej√© la var inutilizable as findopts=${@: }; la retoco a ojo a findopts=${@}, pero queda este aviso si un d√≠a algo no va... como esperar√≠a que fuera
	findopts=$(echo ${@} | grep -v "/Users/violetagonzalezgarcia/gitclones/selvv") # AQU√ç est√° la expansi√≥n de un findterm con regex: findterm*
#	echo "yeah yeah AQU√ç est√° la expansi√≥n findterm*"
fi

if [[ ${findopts} == "" ]]
then
	findopts=" ${ddir} -type f -name "
fi

COLUMNS=12
findhere=$(find ${findopts} ${findterm} | grep -v "version-history" | grep -v "\.git")
select f in ${findhere}  
#select f in $(find ${findopts} ${findterm} | grep -v "version-history" | grep -v "\.git") 
do
	if [[ ${whereto} == true ]]; then
		getwhereto
		${what} ${f} ${where} 
    else
	 	${what} ${f}  
	fi  
	[[ ${cleanit} = true ]] && clear && REPLY=""
#	break
done
